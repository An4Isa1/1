<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pensum Economía UMNG</title>
  <style>
    body {
      font-family: 'Times New Roman', serif;
      background-color: #f8f8f8;
      margin: 0;
      padding: 20px;
    }
    h1, h2 {
      font-family: 'Georgia', serif;
      font-style: italic;
      text-align: center;
    }
    .contenedor-semestres {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 40px;
    }
    .semestre {
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      margin: 10px;
      padding: 10px;
      width: 230px;
    }
    .semestre h3 {
      text-align: center;
      font-weight: bold;
    }
    .materia {
      padding: 6px;
      background-color: #ffffff;
      margin: 4px 0;
      border-radius: 6px;
      cursor: pointer;
    }
    .materia.bloqueada {
      background-color: #ddd;
      color: #888;
      cursor: not-allowed;
    }
    .materia.completada {
      text-decoration: line-through;
      background-color: #c8e6c9;
    }
    .formulario-extra {
      margin-top: 10px;
      padding: 10px;
      background: #f0f0f0;
      border-radius: 8px;
    }
    .formulario-extra input {
      margin: 4px 0;
      padding: 4px;
      width: 100%;
    }
    .info-final {
      margin-top: 60px;
      padding: 20px;
      background-color: #eef;
      border-radius: 12px;
    }
    .semestre-1 { background-color: #ffdddd; }
    .semestre-2 { background-color: #ffeedd; }
    .semestre-3 { background-color: #ffffcc; }
    .semestre-4 { background-color: #ddffdd; }
    .semestre-5 { background-color: #ccffff; }
    .semestre-6 { background-color: #ddeeff; }
    .semestre-7 { background-color: #e0ccff; }
    .semestre-8 { background-color: #ffccf2; }
    .semestre-9 { background-color: #cccccc; }
  </style>
</head>
<body>

<h1>Pensum Economía</h1>
<h2>UMNG</h2>

<div id="contenedor-semestres" class="contenedor-semestres"></div>

<div class="info-final">
  <h2>Información de Profesores, Notas y Promedios</h2>
  <div id="info-extra"></div>
</div>

<script>
  const pensum = [
    {
      numero: 1,
      materias: [
        { nombre: "Economía I", requisitos: [] },
        { nombre: "Matemáticas I", requisitos: [] },
        { nombre: "Historia Económica General", requisitos: [] },
        { nombre: "Contabilidad General", requisitos: [] },
        { nombre: "Lectura y Escritura Académica", requisitos: [] }
      ]
    },
    {
      numero: 2,
      materias: [
        { nombre: "Economía II", requisitos: ["Economía I"] },
        { nombre: "Matemáticas II", requisitos: ["Matemáticas I"] },
        { nombre: "Historia Económica de Colombia", requisitos: ["Historia Económica General"] },
        { nombre: "Contabilidad Nacional", requisitos: ["Contabilidad General"] },
        { nombre: "Estadística I", requisitos: ["Matemáticas I"] }
      ]
    }
    // Puedes continuar agregando los semestres del 3 al 9 aquí con sus materias y requisitos
  ];

  const estadoMaterias = JSON.parse(localStorage.getItem('estadoMaterias')) || {};

  function guardarEstado() {
    localStorage.setItem('estadoMaterias', JSON.stringify(estadoMaterias));
  }

  function crearFormularioExtra(nombreMateria, container) {
    container.innerHTML = `
      <div class="formulario-extra">
        <label>Número de intentos: <input type="number" min="1" value="1" class="input-intentos"></label>
        <div class="contenedor-intentos"></div>
      </div>
    `;

    const inputIntentos = container.querySelector('.input-intentos');
    const contenedorIntentos = container.querySelector('.contenedor-intentos');

    function crearBloquesIntento(num) {
      contenedorIntentos.innerHTML = '';
      for (let i = 1; i <= num; i++) {
        const intento = document.createElement('div');
        intento.innerHTML = `
          <h4>Intento ${i}</h4>
          <label>Profesor: <input type="text" class="profesor"></label>
          <label>Nota 1 (30%): <input type="number" step="0.01" class="nota1"></label>
          <label>Nota 2 (30%): <input type="number" step="0.01" class="nota2"></label>
          <label>Nota 3 (40%): <input type="number" step="0.01" class="nota3"></label>
          <p>Definitiva: <span class="promedio"></span></p>
        `;
        contenedorIntentos.appendChild(intento);

        const inputs = intento.querySelectorAll('input');
        inputs.forEach(input => input.addEventListener('input', () => {
          const n1 = parseFloat(intento.querySelector('.nota1').value) || 0;
          const n2 = parseFloat(intento.querySelector('.nota2').value) || 0;
          const n3 = parseFloat(intento.querySelector('.nota3').value) || 0;
          const promedio = (n1 * 0.3 + n2 * 0.3 + n3 * 0.4).toFixed(2);
          intento.querySelector('.promedio').textContent = promedio;
        }));
      }
    }

    crearBloquesIntento(1);

    inputIntentos.addEventListener('input', () => {
      const cantidad = parseInt(inputIntentos.value) || 1;
      crearBloquesIntento(cantidad);
    });
  }

  function actualizarVista() {
    const contenedor = document.getElementById('contenedor-semestres');
    contenedor.innerHTML = '';

    pensum.forEach(semestre => {
      const div = document.createElement('div');
      div.className = `semestre semestre-${semestre.numero}`;
      div.innerHTML = `<h3>Semestre ${semestre.numero}</h3>`;

      semestre.materias.forEach(materia => {
        const matDiv = document.createElement('div');
        matDiv.className = 'materia';
        matDiv.textContent = materia.nombre;

        const completada = estadoMaterias[materia.nombre]?.completada;
        const requisitosCumplidos = materia.requisitos.every(req => estadoMaterias[req]?.completada);

        if (completada) matDiv.classList.add('completada');
        else if (!requisitosCumplidos) matDiv.classList.add('bloqueada');

        matDiv.addEventListener('click', (e) => {
          e.stopPropagation();
          if (!requisitosCumplidos) return;

          if (!estadoMaterias[materia.nombre]?.completada) {
            estadoMaterias[materia.nombre] = { completada: true };
            guardarEstado();
            matDiv.classList.add('completada');

            const extraForm = document.createElement('div');
            crearFormularioExtra(materia.nombre, extraForm);
            matDiv.appendChild(extraForm);
          }
        });

        div.appendChild(matDiv);
      });

      contenedor.appendChild(div);
    });
  }

  actualizarVista();
</script>

</body>
</html>
